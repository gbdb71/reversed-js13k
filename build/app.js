'use strict';function d(){this.j={}}function g(a,c,b){var e=l,h;e.j[a]=[];b.forEach(function(b,e){this.j[a].push({l:0,count:c,m:[]});for(h=0;h<c;++h){var k=new Audio;k.src=window.jsfxr(b);this.j[a][e].m.push(k)}},e)}d.prototype.play=function(a){a=this.j[a];a=1<a.length?a[0|Math.random()*a.length]:a[0];a.m[a.l].play();a.l<a.count-1?a.l++:a.l=0};var l=new d;g("bip",1,[[1,,.1241,,.1855,.5336,,,,,,,,,,,,,1,,,.1,,.64]]);g("jmp",10,[[1,,.2228,,.2862,.4227,,.2045,,.422,.0985,,,,,,,,1,,,,,.64]]);
g("lvl",2,[[0,,.0109,.5872,.456,.4171,,,,,,.5438,.5084,,,,,,1,,,,,.64]]);g("die",4,[[0,2E-4,.1624,.0376,.8672,.5042,,-.0836,.0925,.1216,.9048,-.2467,.5631,.7993,-.0049,-.7453,-.0034,.0724,.6975,-.896,.9713,.0159,7E-4,.64]]);g("win",1,[[0,.0054,.6188,.0089,.0203,.5365,,.1179,-.0232,.3313,-.9017,-.6238,.9737,-.6086,.6218,.3893,-.0598,.3949,.8977,.4128,.2745,.3614,.0303,.64]]);navigator.userAgent.match(/Android/i)&&(document.body.className+=" and");var n=document.createElement("p");n.style.cssText="pointer-events:auto";"auto"!=n.style.pointerEvents&&(document.body.className+=" nop");n=void 0;"undefined"==typeof requestAnimationFrame&&(["moz","webkit","ms"].some(function(a){a=this[a+"RequestAnimationFrame"];if("function"==typeof a)return requestAnimationFrame=a})||(requestAnimationFrame=function(a){return setTimeout(a,16)}));var p=document.getElementById.bind(document),q=16/9,r,t=1,u=1,v=0,w=0,x=!1,y=p("a"),z=p("b"),A=p("c"),B=p("i"),C=p("p"),D=p("s"),E=p("t");z.width=A.width=960;z.height=A.height=540;
function F(){var a=window.innerWidth,c=window.innerHeight,b;a/c>q?a=c*q:c=a/q;y.style.width=a+"px";y.style.height=c+"px";var e=b=.5*(window.innerWidth-a);y.style.left=e+"px";e=c=.5*(window.innerHeight-c);y.style.top=e+"px";C.style.left=b+"px";C.style.top=c+"px";r=a/960;G();D.style[H]="scale("+r+")translate(600px,240px)";E.style[H]="scale("+r+")translate(40px,160px)"}var H="transform";H in y.style||(H="webkitTransform");
function G(){C.style[H]="scale("+r+")translate("+v+"px,"+(x?w+90:w)+"px)scale("+t+","+(x?-u:u)+")"}F();window.addEventListener("resize",F);window.addEventListener("orientationchange",F);var I=[";     xxx;     x;;;   xx  xx   x;   xx   xx xxx".split(";"),";;;;      xxxx;      xxxx;      xxxx".split(";"),"           vv;;;;;;     ^^".split(";"),"   vvvvvv;;;     xxxxxx;;;       ^^^^^^".split(";"),"   vvvv    vvvv;;;;;         xx;         xx".split(";"),"      vvvv;;;;;       xx;       xx".split(";"),"        vv   vvx;     xxx       x;     x         x;               x;;   xx  xx   x;   xx^^ xx xxx".split(";"),"     vvxxvv;       xx;;;;;       ^^".split(";"),"    vvvvvv;;;;      xxxx;;      ^^^^^^".split(";"),
"    <x    <x;          <x;;;;           <x;     <x    <x".split(";"),"    vvvvxxvvv;;    ^       ^;   <x       x>;    v       v;        ^^;        xx".split(";")," (  (( ( ((  (;   (   (   ( (; (  (  (  (  ( (; (   ( (   ( ((; ( ((  ( ((  ( (;(;".split(";"),";xxxxx;    x;    x;    x;xxxxx;".split(";")],aa=";One small step for a man;Walk softly;Overpass;Easy mode;Jumpy behavior;Tetris all the way down;Timing attack;Reason to fly;A door into summer;Cowards die in shame;Written for js13kGames–2015;This was a triumph".split(";"),
ba=";Click or tap anywhere on the screen to invert gravity;Avoid spikes: they kill you to death!;;;Click or tap in rapid succession while running;;;;;;;Reload the page to start a new game".split(";");var ca={"▄":"n","▀":"*","█":"Ш","░":"/"};function da(a){var c=document.createElement("span");c.appendChild(document.createTextNode(a));c.className="t";C.appendChild(c);a=c.offsetWidth;C.removeChild(c);return a}for(var ea=da("x"),fa=!1,ga=4;ga--;)if(da("▄▀█░"[ga])!=ea){fa=!0;break}
var ha="  █▀▀▀▀▀█   ; ▄█▀▀▀▀▀▀▀▀ ; ▀▀▀▀▀▀▀▀▀▄ ;   ▀▀▀▀▀▀█  ;  ▀▀█▀▀▀█▀  ;  ▀█▀▀▀█▀   ".split(";").map(function(a){return(" ▄▄▄▄▀▀▀▀▀▄ \n█░         █\n█░░  >   < █\n█░░░`  ^  `█\n ▀█░░    █▀ \n o█░░░   █o \n"+a).replace(/./g,function(a){return fa&&ca[a]?ca[a]:a})}),J=document.createElement("p"),K="";ha.forEach(function(a,c){var b=document.createElement("span");b.className="b b"+c;b.appendChild(document.createTextNode(ha[c]));J.appendChild(b);K+="p.a"+c+" .b"+c+"{display:block}"});var ia=document.createElement("style");
ia.appendChild(document.createTextNode(K));document.head.appendChild(ia);J.className="a5";C.appendChild(J);t=92/J.clientWidth;u=90/J.clientHeight;v=434;w=274;F();function ja(a){for(var c=4;c--;)a(),L.translate(21,0),L.rotate(.5*Math.PI)}
function la(){var a=L;a.scale(8,8);a.fillStyle="#fff";ja(function(){a.fillRect(.5,.5,7,7);a.fillRect(8.5,.5,4,3)});a.fillRect(1.5,1.5,18,18);a.fillStyle="#7C7B7C";a.fillRect(2,2,17,17);a.fillStyle="#F9B6C3";a.fillRect(10,2,1,17);a.fillRect(2,10,17,1);a.fillStyle="#E5DDDC";a.beginPath();ja(function(){a.rect(1,1,6,3);a.rect(1,4,5,1);a.rect(1,5,4,1);a.rect(1,6,3,1);a.rect(9,1,3,2);a.rect(8,5,5,4);a.rect(13,6,1,2);a.rect(14,7,1,1)});a.fill();a.fillStyle="#F478A0";a.beginPath();a.rect(7,9,7,2);a.rect(8,
8,2,4);a.rect(11,8,2,4);a.rect(9,10,3,3);a.rect(10,13,1,1);a.fill()};var ma=["xxxxxxxxxxxxxxxx"],I=I.map(function(a){return na(ma.concat(a).concat(ma))});
function na(a){function c(a){if(a.a){var b=a.pop();a.push([h,f,b[2]+1])}else a.push([h,f,1]),a.a=!0}var b=[],e=[],h,f;for(f=9;f--;)for(b.a=!1,e.a=!1,h=16;h--;)"x"==a[f][h]?(8!=f&&"x"!=a[f+1][h]?c(b):b.a=!1,0!=f&&"x"!=a[f-1][h]?c(e):e.a=!1):(b.a=!1,e.a=!1);var m=[];for(h=b.length;h--;)m.push(oa(b[h],1));for(h=e.length;h--;)m.push(oa(e[h]));m.sort(function(a,b){return b[0].y-a[0].y});b=[];e=[];for(h=16;h--;)for(b.a=!1,e.a=!1,f=9;f--;)"x"==a[f][h]?(15!=h&&"x"!=a[f][h+1]?c(b):b.a=!1,0!=h&&"x"!=a[f][h-
1]?c(e):e.a=!1):(b.a=!1,e.a=!1);var k=[];for(h=b.length;h--;)k.push(pa(b[h],1));for(h=e.length;h--;)k.push(pa(e[h]));k.sort(function(a,b){return b[0].x-a[0].x});b=[];for(f=9;f--;)for(b.a=!1,h=16;h--;)a[f][h]in{"^":1,v:1,"<":1,">":1}?c(b):b.a=!1;b=b.map(function(a){return{x:60*a[0],y:60*a[1],width:60*a[2],height:60}});return{c:a,p:m,o:k,s:b}}function oa(a,c){var b=60*(a[1]+(0|c));return[{x:60*a[0],y:b},{x:60*(a[0]+a[2]),y:b}]}
function pa(a,c){var b=60*(a[0]+(0|c));return[{x:b,y:60*a[1]},{x:b,y:60*(a[1]+a[2])}]};var M=[{x:"#FFF691",i:"#F7CA77",p:"#F602FD"},{x:"#04FEFE",i:"#04C0FB",p:"#E1FF5F"},{x:"#FF96F2",i:"#FD2AA1",p:"#F6FE48"},{x:"#27DE78",i:"#60FD93",p:"#FE035D"}],N=0,O=M[N];function qa(){++N==M.length&&(N=0);O=M[N]};var P=z.getContext("2d"),ra=Q(3),sa=Q(6),ta=Q(9);function R(a,c){return~~(Math.random()*(c-a+1))+a}function Q(a){for(var c=[],b=10*(12-a);b--;)c.push({x:R(0,960-a),y:R(60,480-a)});return c}function ua(a){P.clearRect(0,0,960,540);S(ra,3,"#5B8094",a);S(sa,6,"#719CB9",2*a);S(ta,9,"#85B3C5",3*a)}function S(a,c,b,e){P.beginPath();for(var h=10*(12-c);h--;){var f=a[h];f.y-=e;60>f.y?(f.x=R(0,960-c),f.y+=540):480<f.y&&(f.x=R(0,960-c),f.y-=540);P.rect(f.x,f.y,c,c)}P.fillStyle=b;P.fill()};var L=A.getContext("2d");function va(a){L.font=a+"px 'Segoe UI','Helvetica Neue',sans-serif"}L.textAlign="center";
function wa(a){var c,b,e=I[a];L.clearRect(0,0,960,540);L.beginPath();for(c=16;c--;)for(b=9;b--;)"x"==e.c[b][c]&&L.rect(60*c,60*b,60,60);L.fillStyle=O.x;L.fill();L.fillStyle=L.strokeStyle=O.i;a%2?xa():ya();L.beginPath();for(c=16;c--;)for(b=9;b--;)"^"==e.c[b][c]?za(c,b,0):"v"==e.c[b][c]?za(c,b,1):"<"==e.c[b][c]?Aa(c,b,0):">"==e.c[b][c]?Aa(c,b,1):"("==e.c[b][c]&&(L.fillStyle="#FFEB3B",L.fillRect(54*c+48,54*(b+.5)+27,54,54));L.fillStyle="#FEFDFB";L.fill();L.save();L.beginPath();for(c=16;c--;)for(b=9;b--;)"^"==
e.c[b][c]?L.rect(60*c,60*b,60,30):"v"==e.c[b][c]?L.rect(60*c,60*(b+.5),60,30):"<"==e.c[b][c]?L.rect(60*c,60*b,30,60):">"==e.c[b][c]&&L.rect(60*(c+.5),60*b,30,60);L.globalCompositeOperation="source-atop";L.fillStyle="#FE0302";L.fill();L.restore();L.beginPath();e.p.concat(e.o).forEach(function(a){L.moveTo(a[0].x,a[0].y);L.lineTo(a[1].x,a[1].y)});L.lineCap="square";L.lineWidth=2;L.strokeStyle=O.p;L.stroke();va(25);aa[a]&&Ba('"'+aa[a]+'"',521);ba[a]&&Ba("PROTIP: "+ba[a],40)}
function Ba(a,c){var b=c-25,e=b+16,h=e+16,f=.5*(960-L.measureText(a).width);L.beginPath();L.moveTo(f,b);L.lineTo(960-f,b);L.quadraticCurveTo(960-f+16,b,960-f+16,e);L.quadraticCurveTo(960-f+16,h,960-f,h);L.lineTo(f,h);L.quadraticCurveTo(f-16,h,f-16,e);L.quadraticCurveTo(f-16,b,f,b);L.fillStyle="rgba(0,0,0,0.5)";L.fill();L.fillStyle="#fff";L.fillText(a,480,c,900)}
function za(a,c,b){L.moveTo(60*a,60*(c+(b^=1)));L.lineTo(60*(a+.25),60*(c+(b^=1)));L.lineTo(60*(a+.5),60*(c+(b^=1)));L.lineTo(60*(a+.75),60*(c+(b^=1)));L.lineTo(60*(a+1),60*(c+(b^1)))}function Aa(a,c,b){L.moveTo(60*(a+(b^=1)),60*c);L.lineTo(60*(a+(b^=1)),60*(c+.25));L.lineTo(60*(a+(b^=1)),60*(c+.5));L.lineTo(60*(a+(b^=1)),60*(c+.75));L.lineTo(60*(a+(b^1)),60*(c+1))}
function xa(){var a=2,c=6.26E-4,b=.5>Math.random()?-.1:.1,e;.5>Math.random()&&(a=4,c=-c);L.save();L.translate(480,270);L.rotate(.5>Math.random()?.5*b:b);L.translate(-480,-270);L.globalCompositeOperation="source-atop";for(b=-10;58>b;++b){L.beginPath();for(e=-10;37>e;++e)L.arc(20*(b+.5),20*(e+.5),a+=c,0,2*Math.PI);L.fill()}L.restore()}
function ya(){var a=10*Math.sqrt(2),c;L.save();L.translate(480,270);L.rotate(.25*(.5>Math.random()?-1:1)*Math.PI);L.translate(-479.5,-269.5);L.globalCompositeOperation="source-atop";L.beginPath();for(c=-960;1920>c;c+=a)L.moveTo(c,-540),L.lineTo(c,1080);L.lineWidth=2;L.stroke();L.restore()}wa(0);function Ca(a,c,b,e){return((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))*((c.x-a.x)*(e.y-a.y)-(e.x-a.x)*(c.y-a.y))}function Da(a,c,b){var e;if(!(e=b[0].y<a[0].y==b[0].y<c[0].y)&&(e=0<Ca(a[0],c[0],b[0],b[1])&&0<Ca(a[1],c[1],b[0],b[1]))){var h=b[0];e=h.x-a[0].x;var h=h.y-a[0].y,f=a[1].x-a[0].x,m=c[0].x-a[0].x,k=c[0].y-a[0].y,ka=f*k-0*m,f=-(0*e-f*h)/ka;e=(e*k-m*h)/ka;e=!(0<=f&&1>=f&&0<=e&&1>=e)}e||(c[0].y=c[1].y=b[0].y+(a[0].y>c[0].y?1:-1),c.b=0,c.h=!0)};function T(){x=!1;return{x:10,y:225,width:92,height:90,g:.1,h:!1,f:4,b:0}}
function U(a){a>=I.length&&(a=I.length-1);wa(Ea=a);Fa=I[a].p;Ga=I[a].o;V=I[a].s;if(a==I.length-1){L.save();L.translate(706,314);la();L.restore();a=Math.min(Math.max(420,690),680);var c=Math.min(Math.max(440,710),700);L.beginPath();L.moveTo(420,100);L.lineTo(700,100);L.quadraticCurveTo(740,100,740,140);L.lineTo(740,260);L.quadraticCurveTo(740,300,700,300);L.lineTo(c,300);L.lineTo(700,330);L.lineTo(a,300);L.lineTo(420,300);L.quadraticCurveTo(380,300,380,260);L.lineTo(380,140);L.quadraticCurveTo(380,
100,420,100);L.fillStyle="rgba(229,221,220,0.6)";L.fill();L.lineWidth=2;L.strokeStyle="#fff";L.stroke();va(40);L.fillStyle="#101010";L.fillText("You've beat the game,",560,150,320);L.fillText("ASCII person.",560,192,320);L.fillText("But your princess is",560,234,320);L.fillText("in another castle.",560,276,320);l.play("win")}else a&&l.play(1==a?"bip":"lvl")}var W=T(),Ea,Fa,Ga,V;U(0);var X;
function Ha(){var a=Date.now(),c=a-X;X=a;W.h&&(W.f+=.1*c,4<W.f&&(W.f=4));W.b+=c*W.g;var b;b=0>W.b?[{x:W.x,y:W.y}]:[{x:W.x,y:W.y+W.height}];b.push({x:b[0].x+W.width,y:b[0].y});var e=[{x:b[0].x+W.f,y:b[0].y+W.b}];e.push({x:e[0].x+W.width,y:e[0].y});e.b=W.b;e.h=!1;Fa.forEach(function(a){Da(b,e,a)});0>W.b?W.y=e[0].y:W.y=e[0].y-W.height;W.b=e.b;W.h=e.h;b=[{x:W.y,y:W.x+W.width}];b.push({x:b[0].x+W.height,y:b[0].y});e=[{x:b[0].x+W.b,y:b[0].y+W.f}];e.push({x:e[0].x+W.height,y:e[0].y});e.b=W.f;Ga.forEach(function(a){a=
[{x:a[0].y,y:a[0].x},{x:a[1].y,y:a[1].x}];Da(b,e,a)});W.x=e[0].y-W.width;W.f=e.b;J.className="a"+(a>>>6)%6;return c}var Y=!1;function Ia(){var a=Date.now(),c=a-X;X=a;Y||(requestAnimationFrame(Ia),ua(c*W.g))}X=Date.now();requestAnimationFrame(Ia);function Ja(){requestAnimationFrame(Ja);940<W.x+W.width&&(W=T(),qa(),U(Ea+1));for(var a=V.length;a--;){var c=V[a],b=W;if(b.x<c.x+c.width&&b.x+b.width>c.x&&b.y<c.y+c.height&&b.height+b.y>c.y){l.play("die");W=T();break}}ua(Ha()*W.g);v=W.x;w=W.y;G()}
function Ka(a){a.preventDefault();Y||(Y=!0,D.style.display=E.style.display="none",B.style.pointerEvents="auto",W=T(),qa(),U(1),X=Date.now(),requestAnimationFrame(Ja))}D.addEventListener("click",Ka);D.addEventListener("touchstart",Ka);function Z(a){a.preventDefault();l.play("jmp");W.g=-W.g;x=!x}document.body.addEventListener("keyup",function(a){32!=a.which&&32!=a.keyCode||Z(a)});B.addEventListener("click",Z);B.addEventListener("touchstart",Z);
